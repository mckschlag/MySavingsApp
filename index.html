<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savings Growth Pro</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding: 20px; background-color: #f4f7f6; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; }
        .box { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h2 { color: #2c3e50; margin-top: 0; text-align: center; }
        label { font-weight: bold; display: block; margin-top: 15px; color: #555; font-size: 14px; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; -webkit-appearance: none; }
        button { width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; margin-top: 20px; cursor: pointer; }
        button:active { background-color: #0056b3; }
        #output { margin-top: 25px; font-size: 17px; color: #333; line-height: 1.6; border-top: 1px solid #eee; padding-top: 15px; min-height: 50px; }
        .highlight { color: #28a745; font-weight: bold; }
        .muted { color: #888; font-size: 13px; margin-top: 8px; }
    </style>
</head>
<body>
    <noscript style="color:#c00; text-align:center; width:100%;">JavaScript is required for this page. Please enable JavaScript and reload.</noscript>

    <div class="box" id="app">
        <h2>ðŸ“ˆ Growth Calculator</h2>

        <label>Starting Balance ($)</label>
        <input type="text" id="starting" inputmode="numeric" placeholder="0" oninput="formatBox(this)">

        <label>Savings Goal ($)</label>
        <input type="text" id="goal" inputmode="numeric" placeholder="10,000" oninput="formatBox(this)">

        <label>Monthly Contribution ($)</label>
        <input type="text" id="monthly" inputmode="numeric" placeholder="500" oninput="formatBox(this)">

        <label>Annual Interest Rate (%)</label>
        <input type="number" id="interest" placeholder="5" step="0.1">

        <button id="calcBtn" type="button">Calculate Growth</button>
        <div id="output" aria-live="polite"></div>
        <div class="muted">Tip: leave interest as 0 for no returns; enter monthly &gt; 0.</div>
    </div>

    <script>
        // Debug marker to confirm script runs
        console.log('index.html loaded');

        function formatBox(input) {
            // Keep only digits so user can use commas while typing
            try {
                let value = input.value.replace(/\D/g, "");
                if (value !== "") {
                    input.value = Number(value).toLocaleString();
                }
            } catch (e) {
                // Don't let formatting break the page
                console.error('formatBox error', e);
            }
        }

        function calculate() {
            console.log('Calculate clicked');
            const output = document.getElementById('output');

            try {
                const startStr = document.getElementById('starting').value.replace(/,/g, "") || "0";
                const goalStr = document.getElementById('goal').value.replace(/,/g, "") || "0";
                const monthlyStr = document.getElementById('monthly').value.replace(/,/g, "") || "0";
                const interestRaw = document.getElementById('interest').value;

                const startBal = parseFloat(startStr) || 0;
                const goal = parseFloat(goalStr) || 0;
                const monthly = parseFloat(monthlyStr) || 0;
                const annualRate = (interestRaw === "" || isNaN(parseFloat(interestRaw))) ? 0 : parseFloat(interestRaw) / 100;

                console.log({startBal, goal, monthly, annualRate});

                const formatter = new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    maximumFractionDigits: 0
                });

                if (goal <= 0) {
                    output.innerHTML = "Please enter a positive savings goal.";
                    return;
                }

                if (startBal >= goal) {
                    output.innerHTML = "You've already reached your goal! ðŸŽ‰";
                    return;
                }

                // If neither monthly nor interest are positive, goal can't be reached
                if (monthly <= 0 && annualRate <= 0) {
                    output.innerHTML = "Please enter a monthly contribution or a positive interest rate.";
                    return;
                }

                let monthsToGoal = NaN;

                // No interest (or non-positive interest): simple linear accumulation
                if (annualRate <= 0) {
                    if (monthly <= 0) {
                        output.innerHTML = "With zero monthly contributions, the goal is unreachable.";
                        return;
                    }
                    monthsToGoal = Math.ceil((goal - startBal) / monthly);
                } else {
                    // Compound interest case with monthly contributions
                    const r = annualRate / 12;
                    const P = monthly;
                    const FV = goal;
                    const PV = startBal;

                    // Validate formula inputs to avoid division by zero / negative logs
                    const denom = PV * r + P;
                    const numer = FV * r + P;

                    console.log({r, P, PV, FV, denom, numer});

                    if (denom <= 0 || numer <= 0) {
                        output.innerHTML = "Goal is mathematically unreachable with these numbers.";
                        return;
                    }

                    const ratio = numer / denom;
                    if (ratio <= 0) {
                        output.innerHTML = "Goal is mathematically unreachable with these numbers.";
                        return;
                    }

                    const n = Math.log(ratio) / Math.log(1 + r);
                    monthsToGoal = Math.ceil(n);
                }

                if (!isFinite(monthsToGoal) || isNaN(monthsToGoal) || monthsToGoal < 0) {
                    output.innerHTML = "Goal is mathematically unreachable with these numbers.";
                    return;
                }

                const years = Math.floor(monthsToGoal / 12);
                const remainingMonths = monthsToGoal % 12;

                output.innerHTML = `To reach <span class="highlight">${formatter.format(goal)}</span>, it will take <span class="highlight">${monthsToGoal} months</span>.<br><br>` +
                                   `That is <strong>${years} year(s) and ${remainingMonths} month(s)</strong>.`;

                console.log('Result:', monthsToGoal, 'months');

            } catch (err) {
                console.error('calculate error', err);
                output.innerHTML = "Something went wrong. Check your numbers!";
            }
        }

        // Attach event listener (safer than inline onclick)
        document.getElementById('calcBtn').addEventListener('click', calculate);

        // Optionally log that the DOM is ready
        console.log('Script initialized successfully');
    </script>
</body>
</html>
